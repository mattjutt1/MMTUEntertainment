[00.07][WARNING](ca-certs): Ignored 1 trust anchors.
/home/matt/.local/share/pipx/venvs/semgrep/lib/python3.12/site-packages/opentelemetry/instrumentation/dependencies.py:4: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import (
               
               
┌─────────────┐
│ Scan Status │
└─────────────┘
  Scanning 154 files tracked by git with 1062 Code rules:
                                                                                                                        
  Language      Rules   Files          Origin      Rules                                                                
 ─────────────────────────────        ───────────────────                                                               
  <multilang>      61     154          Community    1062                                                                
  json              4      26                                                                                           
  ts              166      17                                                                                           
  yaml             31      17                                                                                           
  js              156       9                                                                                           
  php              38       2                                                                                           
  bash              4       2                                                                                           
  python          243       1                                                                                           
  terraform       101       1                                                                                           
  html              1       1                                                                                           
                                                                                                                        
{"version":"1.131.0","results":[{"check_id":"javascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring","path":"packages/analytics/test.simple.js","start":{"line":6,"col":17,"offset":174},"end":{"line":6,"col":36,"offset":193},"extra":{"message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","metadata":{"cwe":["CWE-134: Use of Externally-Controlled Format String"],"owasp":["A01:2021 - Broken Access Control"],"category":"security","technology":["javascript"],"subcategory":["audit"],"likelihood":"MEDIUM","impact":"LOW","confidence":"LOW","references":["https://cwe.mitre.org/data/definitions/134.html"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Validation"],"source":"https://semgrep.dev/r/javascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring","shortlink":"https://sg.run/7Y5R"},"severity":"INFO","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"javascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring","path":"packages/portfolio-analytics/src/cloudflare-integration.ts","start":{"line":142,"col":21,"offset":4465},"end":{"line":142,"col":76,"offset":4520},"extra":{"message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","metadata":{"cwe":["CWE-134: Use of Externally-Controlled Format String"],"owasp":["A01:2021 - Broken Access Control"],"category":"security","technology":["javascript"],"subcategory":["audit"],"likelihood":"MEDIUM","impact":"LOW","confidence":"LOW","references":["https://cwe.mitre.org/data/definitions/134.html"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Validation"],"source":"https://semgrep.dev/r/javascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring","shortlink":"https://sg.run/7Y5R"},"severity":"INFO","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"javascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring","path":"packages/portfolio-analytics/src/cloudflare-integration.ts","start":{"line":219,"col":21,"offset":6863},"end":{"line":219,"col":72,"offset":6914},"extra":{"message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","metadata":{"cwe":["CWE-134: Use of Externally-Controlled Format String"],"owasp":["A01:2021 - Broken Access Control"],"category":"security","technology":["javascript"],"subcategory":["audit"],"likelihood":"MEDIUM","impact":"LOW","confidence":"LOW","references":["https://cwe.mitre.org/data/definitions/134.html"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Validation"],"source":"https://semgrep.dev/r/javascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring","shortlink":"https://sg.run/7Y5R"},"severity":"INFO","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"javascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring","path":"packages/portfolio-analytics/src/cloudflare-integration.ts","start":{"line":231,"col":19,"offset":7289},"end":{"line":231,"col":58,"offset":7328},"extra":{"message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","metadata":{"cwe":["CWE-134: Use of Externally-Controlled Format String"],"owasp":["A01:2021 - Broken Access Control"],"category":"security","technology":["javascript"],"subcategory":["audit"],"likelihood":"MEDIUM","impact":"LOW","confidence":"LOW","references":["https://cwe.mitre.org/data/definitions/134.html"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Validation"],"source":"https://semgrep.dev/r/javascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring","shortlink":"https://sg.run/7Y5R"},"severity":"INFO","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"javascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring","path":"packages/portfolio-analytics/src/cloudflare-integration.ts","start":{"line":239,"col":21,"offset":7617},"end":{"line":239,"col":66,"offset":7662},"extra":{"message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","metadata":{"cwe":["CWE-134: Use of Externally-Controlled Format String"],"owasp":["A01:2021 - Broken Access Control"],"category":"security","technology":["javascript"],"subcategory":["audit"],"likelihood":"MEDIUM","impact":"LOW","confidence":"LOW","references":["https://cwe.mitre.org/data/definitions/134.html"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Validation"],"source":"https://semgrep.dev/r/javascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring","shortlink":"https://sg.run/7Y5R"},"severity":"INFO","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"javascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring","path":"packages/portfolio-analytics/src/dashboard-data.ts","start":{"line":129,"col":25,"offset":4400},"end":{"line":129,"col":76,"offset":4451},"extra":{"message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","metadata":{"cwe":["CWE-134: Use of Externally-Controlled Format String"],"owasp":["A01:2021 - Broken Access Control"],"category":"security","technology":["javascript"],"subcategory":["audit"],"likelihood":"MEDIUM","impact":"LOW","confidence":"LOW","references":["https://cwe.mitre.org/data/definitions/134.html"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Validation"],"source":"https://semgrep.dev/r/javascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring","shortlink":"https://sg.run/7Y5R"},"severity":"INFO","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"javascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring","path":"packages/portfolio-analytics/src/dashboard-data.ts","start":{"line":237,"col":21,"offset":7708},"end":{"line":237,"col":75,"offset":7762},"extra":{"message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","metadata":{"cwe":["CWE-134: Use of Externally-Controlled Format String"],"owasp":["A01:2021 - Broken Access Control"],"category":"security","technology":["javascript"],"subcategory":["audit"],"likelihood":"MEDIUM","impact":"LOW","confidence":"LOW","references":["https://cwe.mitre.org/data/definitions/134.html"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Validation"],"source":"https://semgrep.dev/r/javascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring","shortlink":"https://sg.run/7Y5R"},"severity":"INFO","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"javascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring","path":"packages/portfolio-analytics/src/dashboard-data.ts","start":{"line":260,"col":21,"offset":8625},"end":{"line":260,"col":73,"offset":8677},"extra":{"message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","metadata":{"cwe":["CWE-134: Use of Externally-Controlled Format String"],"owasp":["A01:2021 - Broken Access Control"],"category":"security","technology":["javascript"],"subcategory":["audit"],"likelihood":"MEDIUM","impact":"LOW","confidence":"LOW","references":["https://cwe.mitre.org/data/definitions/134.html"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Validation"],"source":"https://semgrep.dev/r/javascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring","shortlink":"https://sg.run/7Y5R"},"severity":"INFO","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"javascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring","path":"packages/portfolio-analytics/src/dora-metrics.ts","start":{"line":84,"col":23,"offset":2939},"end":{"line":84,"col":75,"offset":2991},"extra":{"message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","metadata":{"cwe":["CWE-134: Use of Externally-Controlled Format String"],"owasp":["A01:2021 - Broken Access Control"],"category":"security","technology":["javascript"],"subcategory":["audit"],"likelihood":"MEDIUM","impact":"LOW","confidence":"LOW","references":["https://cwe.mitre.org/data/definitions/134.html"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Validation"],"source":"https://semgrep.dev/r/javascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring","shortlink":"https://sg.run/7Y5R"},"severity":"INFO","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"javascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring","path":"packages/portfolio-analytics/src/dora-metrics.ts","start":{"line":129,"col":23,"offset":4594},"end":{"line":129,"col":73,"offset":4644},"extra":{"message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","metadata":{"cwe":["CWE-134: Use of Externally-Controlled Format String"],"owasp":["A01:2021 - Broken Access Control"],"category":"security","technology":["javascript"],"subcategory":["audit"],"likelihood":"MEDIUM","impact":"LOW","confidence":"LOW","references":["https://cwe.mitre.org/data/definitions/134.html"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Validation"],"source":"https://semgrep.dev/r/javascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring","shortlink":"https://sg.run/7Y5R"},"severity":"INFO","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"javascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring","path":"packages/portfolio-analytics/src/posthog-portfolio.ts","start":{"line":305,"col":19,"offset":8937},"end":{"line":305,"col":52,"offset":8970},"extra":{"message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","metadata":{"cwe":["CWE-134: Use of Externally-Controlled Format String"],"owasp":["A01:2021 - Broken Access Control"],"category":"security","technology":["javascript"],"subcategory":["audit"],"likelihood":"MEDIUM","impact":"LOW","confidence":"LOW","references":["https://cwe.mitre.org/data/definitions/134.html"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Validation"],"source":"https://semgrep.dev/r/javascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring","shortlink":"https://sg.run/7Y5R"},"severity":"INFO","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"javascript.lang.security.detect-child-process.detect-child-process","path":"scripts/repo_audit.mjs","start":{"line":29,"col":21,"offset":760},"end":{"line":29,"col":28,"offset":767},"extra":{"message":"Detected calls to child_process from a function argument `command`. This could lead to a command injection if the input is user controllable. Try to avoid calls to child_process, and if it is needed ensure user input is correctly sanitized or sandboxed. ","metadata":{"cwe":["CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"],"owasp":["A01:2017 - Injection","A03:2021 - Injection"],"references":["https://cheatsheetseries.owasp.org/cheatsheets/Nodejs_Security_Cheat_Sheet.html#do-not-use-dangerous-functions"],"source-rule-url":"https://github.com/nodesecurity/eslint-plugin-security/blob/master/rules/detect-child-process.js","category":"security","technology":["javascript"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"HIGH","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Command Injection"],"source":"https://semgrep.dev/r/javascript.lang.security.detect-child-process.detect-child-process","shortlink":"https://sg.run/l2lo"},"severity":"ERROR","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal","path":"scripts/repo_audit.mjs","start":{"line":48,"col":31,"offset":1335},"end":{"line":48,"col":34,"offset":1338},"extra":{"message":"Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.","metadata":{"owasp":["A05:2017 - Broken Access Control","A01:2021 - Broken Access Control"],"cwe":["CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"],"category":"security","references":["https://owasp.org/www-community/attacks/Path_Traversal"],"technology":["javascript","node.js"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"HIGH","impact":"MEDIUM","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Path Traversal"],"source":"https://semgrep.dev/r/javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal","shortlink":"https://sg.run/OPqk"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal","path":"scripts/repo_audit.mjs","start":{"line":48,"col":36,"offset":1340},"end":{"line":48,"col":40,"offset":1344},"extra":{"message":"Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.","metadata":{"owasp":["A05:2017 - Broken Access Control","A01:2021 - Broken Access Control"],"cwe":["CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"],"category":"security","references":["https://owasp.org/www-community/attacks/Path_Traversal"],"technology":["javascript","node.js"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"HIGH","impact":"MEDIUM","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Path Traversal"],"source":"https://semgrep.dev/r/javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal","shortlink":"https://sg.run/OPqk"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal","path":"scripts/repo_audit.mjs","start":{"line":163,"col":37,"offset":4438},"end":{"line":163,"col":40,"offset":4441},"extra":{"message":"Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.","metadata":{"owasp":["A05:2017 - Broken Access Control","A01:2021 - Broken Access Control"],"cwe":["CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"],"category":"security","references":["https://owasp.org/www-community/attacks/Path_Traversal"],"technology":["javascript","node.js"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"HIGH","impact":"MEDIUM","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Path Traversal"],"source":"https://semgrep.dev/r/javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal","shortlink":"https://sg.run/OPqk"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal","path":"scripts/repo_audit.mjs","start":{"line":167,"col":30,"offset":4541},"end":{"line":167,"col":33,"offset":4544},"extra":{"message":"Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.","metadata":{"owasp":["A05:2017 - Broken Access Control","A01:2021 - Broken Access Control"],"cwe":["CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"],"category":"security","references":["https://owasp.org/www-community/attacks/Path_Traversal"],"technology":["javascript","node.js"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"HIGH","impact":"MEDIUM","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Path Traversal"],"source":"https://semgrep.dev/r/javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal","shortlink":"https://sg.run/OPqk"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}}],"errors":[{"code":3,"level":"warn","type":"Lexical error","message":"Lexical error at line security-audit-results/semgrep-sast.json:6:\n unrecognised symbol, in token rule:�","path":"security-audit-results/semgrep-sast.json"},{"code":3,"level":"warn","type":"Lexical error","message":"Lexical error at line security-audit-results/ai-security.json:1:\n unrecognised symbol, in token rule:�","path":"security-audit-results/ai-security.json"},{"code":3,"level":"warn","type":"Syntax error","message":"Syntax error at line security-audit-results/trivy-vulnerabilities.json:1:\n `T22` was unexpected","path":"security-audit-results/trivy-vulnerabilities.json"},{"code":3,"level":"warn","type":"Syntax error","message":"Syntax error at line security-audit-results/trufflehog-secrets.json:2:\n `{` was unexpected","path":"security-audit-results/trufflehog-secrets.json"},{"code":2,"level":"warn","type":"Other syntax error","message":"Other syntax error at line .github/workflows/gatekeeper.yml:106:\n (approximate error location; error nearby after) error calling parser: did not find expected alphabetic or numeric character character 0 position 0 returned: 0","path":".github/workflows/gatekeeper.yml"},{"code":3,"level":"warn","type":["PartialParsing",[{"path":".github/workflows/e2e-tests.yml","start":{"line":99,"col":50,"offset":2936},"end":{"line":99,"col":53,"offset":2939}}]],"message":"Syntax error at line .github/workflows/e2e-tests.yml:99:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `${{` was unexpected","path":".github/workflows/e2e-tests.yml","spans":[{"file":".github/workflows/e2e-tests.yml","start":{"line":99,"col":50,"offset":2936},"end":{"line":99,"col":53,"offset":2939}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":".github/workflows/e2e-tests.yml","start":{"line":133,"col":20,"offset":4021},"end":{"line":149,"col":6,"offset":4517}}]],"message":"Syntax error at line .github/workflows/e2e-tests.yml:133:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `\"## E2E Test Results R`On\" > test-summary.md\necho \"\" >> test-summary.md\necho \"| Browser | Scenario | Status |\" >> test-summary.md\necho \"|---------|----------|--------|\" >> test-summary.md\n\nfor result in e2e-results-*; do\n  browser=$(echo $result | cut -d'-' -f3)\n  scenario=$(echo $result | cut -d'-' -f4)\n  \n  if [ -f \"$result/test-results/results.json\" ]; then\n    status=\"D]F Passed\"\n  else\n    status=\"D^M Failed\"  \n  fi\n  \n  echo \"| $browser | $scenario | $status |\" >> test-summary.md\ndone\n` was unexpected","path":".github/workflows/e2e-tests.yml","spans":[{"file":".github/workflows/e2e-tests.yml","start":{"line":133,"col":20,"offset":4021},"end":{"line":149,"col":6,"offset":4517}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":".github/workflows/e2e-tests.yml","start":{"line":178,"col":20,"offset":5487},"end":{"line":191,"col":3,"offset":6177}}]],"message":"Syntax error at line .github/workflows/e2e-tests.yml:178:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `\"R`Op Running gatekeeper validation...\"\n\n# Check if tests passed for critical scenarios\nif [[ \"${{ needs.e2e-tests.result }}\" == \"success\" ]]; then\n  echo \"D]F E2E tests passed - experiments ready for promotion\"\n  \n  # Log success to runlog\n  cat >> .orchestrator/runlog.jsonl << EOF\n{\"ts\":\"$(date -Iseconds)\",\"actor\":\"playwright_ci\",\"action\":\"validate\",\"exp\":\"e2e_test_suite\",\"from\":\"testing\",\"to\":\"validated\",\"sample\":0,\"metrics\":{\"browsers_tested\":3,\"scenarios_tested\":3,\"success_rate\":1.0},\"decision\":\"ALLOW\",\"reason\":\"All E2E tests passed - bundle upsell, pricing experiment, feature flags validated\"}\nEOF\nelse\n  echo \"D^M E2E tests failed - blocking experiment promotion\" \n  exit 1\nfi` was unexpected","path":".github/workflows/e2e-tests.yml","spans":[{"file":".github/workflows/e2e-tests.yml","start":{"line":178,"col":20,"offset":5487},"end":{"line":191,"col":3,"offset":6177}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":".github/workflows/playwright.yml","start":{"line":66,"col":44,"offset":1501},"end":{"line":66,"col":47,"offset":1504}},{"path":".github/workflows/playwright.yml","start":{"line":66,"col":76,"offset":1501},"end":{"line":66,"col":98,"offset":1523}}]],"message":"Syntax error at line .github/workflows/playwright.yml:66:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `${{` was unexpected","path":".github/workflows/playwright.yml","spans":[{"file":".github/workflows/playwright.yml","start":{"line":66,"col":44,"offset":1501},"end":{"line":66,"col":47,"offset":1504}},{"file":".github/workflows/playwright.yml","start":{"line":66,"col":76,"offset":1501},"end":{"line":66,"col":98,"offset":1523}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":".github/workflows/portfolio-monitoring.yml","start":{"line":141,"col":11,"offset":4599},"end":{"line":141,"col":46,"offset":4634}},{"path":".github/workflows/portfolio-monitoring.yml","start":{"line":144,"col":11,"offset":4599},"end":{"line":144,"col":50,"offset":4638}}]],"message":"Syntax error at line .github/workflows/portfolio-monitoring.yml:141:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `{ steps.dora.outputs.warning_alerts` was unexpected","path":".github/workflows/portfolio-monitoring.yml","spans":[{"file":".github/workflows/portfolio-monitoring.yml","start":{"line":141,"col":11,"offset":4599},"end":{"line":141,"col":46,"offset":4634}},{"file":".github/workflows/portfolio-monitoring.yml","start":{"line":144,"col":11,"offset":4599},"end":{"line":144,"col":50,"offset":4638}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":".github/workflows/portfolio-monitoring.yml","start":{"line":172,"col":13,"offset":5892},"end":{"line":205,"col":39,"offset":6889}}]],"message":"Syntax error at line .github/workflows/portfolio-monitoring.yml:172:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `CRITICAL=${{ needs.collect-metrics.outputs.critical_alerts }}\nWARNING=${{ needs.collect-metrics.outputs.warning_alerts }}\nUNHEALTHY=${{ needs.collect-metrics.outputs.unhealthy_products }}\nTIMESTAMP=\"${{ needs.collect-metrics.outputs.timestamp }}\"\n\nif [ \"$CRITICAL\" -gt \"0\" ]; then\n  SEVERITY=\"R`[i CRITICAL\"\n  COLOR=\"danger\"\nelif [ \"$WARNING\" -gt \"0\" ]; then\n  SEVERITY=\"D[aQyP WARNING\"\n  COLOR=\"warning\" \nelse\n  SEVERITY=\"DEzQyP INFO\"\n  COLOR=\"good\"\nfi\n\nMESSAGE=\"$SEVERITY: Portfolio Health Alert\n\nR`TK **Portfolio Status Update** - $TIMESTAMP\n\nR`Uu Critical Alerts: $CRITICAL\nR``b Warning Alerts: $WARNING  \nR`Pf Unhealthy Products: $UNHEALTHY\n\nR`TI **View Dashboard**: https://portfolio-dashboard.mmtu.app\nR`Uh **Take Action**: Review alerts and investigate issues\n\nGenerated by Portfolio Monitoring Workflow\"\n\necho \"MESSAGE<<EOF\" >> $GITHUB_OUTPUT\necho \"$MESSAGE\" >> $GITHUB_OUTPUT\necho \"EOF\" >> $GITHUB_OUTPUT\necho \"SEVERITY=$SEVERITY\" >> $GITHUB_OUTPUT\necho \"COLOR=$COLOR\" >> $GITHUB_OUTPUT\n` was unexpected","path":".github/workflows/portfolio-monitoring.yml","spans":[{"file":".github/workflows/portfolio-monitoring.yml","start":{"line":172,"col":13,"offset":5892},"end":{"line":205,"col":39,"offset":6889}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":".github/workflows/portfolio-monitoring.yml","start":{"line":302,"col":18,"offset":10558},"end":{"line":306,"col":75,"offset":10867}}]],"message":"Syntax error at line .github/workflows/portfolio-monitoring.yml:302:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `\"R`UU Alert notification sent successfully\"\necho \"Severity: ${{ steps.alert.outputs.SEVERITY }}\"\necho \"Critical: ${{ needs.collect-metrics.outputs.critical_alerts }}\"\necho \"Warning: ${{ needs.collect-metrics.outputs.warning_alerts }}\"\necho \"Unhealthy: ${{ needs.collect-metrics.outputs.unhealthy_products }}\"\n` was unexpected","path":".github/workflows/portfolio-monitoring.yml","spans":[{"file":".github/workflows/portfolio-monitoring.yml","start":{"line":302,"col":18,"offset":10558},"end":{"line":306,"col":75,"offset":10867}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":".github/workflows/portfolio-monitoring.yml","start":{"line":320,"col":6,"offset":11098},"end":{"line":328,"col":62,"offset":11518}}]],"message":"Syntax error at line .github/workflows/portfolio-monitoring.yml:320:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `\"R`TK Dashboard data collected successfully\"\necho \"Timestamp: ${{ needs.collect-metrics.outputs.timestamp }}\"\necho \"Data available for dashboard consumption\"\n\n# Example: Push to time-series database\n# curl -X POST \"https://api.timeseriesdb.com/v1/metrics\" \\\n#   -H \"Authorization: Bearer ${{ secrets.TSDB_TOKEN }}\" \\\n#   -H \"Content-Type: application/json\" \\\n#   -d '${{ needs.collect-metrics.outputs.dashboard_data }}'\n` was unexpected","path":".github/workflows/portfolio-monitoring.yml","spans":[{"file":".github/workflows/portfolio-monitoring.yml","start":{"line":320,"col":6,"offset":11098},"end":{"line":328,"col":62,"offset":11518}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":".github/workflows/portfolio-monitoring.yml","start":{"line":352,"col":18,"offset":12541},"end":{"line":365,"col":4,"offset":13022}}]],"message":"Syntax error at line .github/workflows/portfolio-monitoring.yml:352:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `\"R`TI Analyzing DORA metrics trends...\"\n\n# In a real implementation, this would:\n# 1. Compare current metrics to historical trends\n# 2. Identify performance regressions  \n# 3. Generate improvement recommendations\n# 4. Create performance reports\n\necho \"DORA analysis completed\"\n\n# Example metrics analysis\nif [ \"${{ needs.collect-metrics.outputs.critical_alerts }}\" -gt \"5\" ]; then\n  echo \"::warning::High number of critical alerts detected - review incident response processes\"\nfi\n` was unexpected","path":".github/workflows/portfolio-monitoring.yml","spans":[{"file":".github/workflows/portfolio-monitoring.yml","start":{"line":352,"col":18,"offset":12541},"end":{"line":365,"col":4,"offset":13022}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":".github/workflows/portfolio-monitoring.yml","start":{"line":372,"col":18,"offset":13197},"end":{"line":372,"col":59,"offset":13238}},{"path":".github/workflows/portfolio-monitoring.yml","start":{"line":373,"col":17,"offset":13197},"end":{"line":373,"col":34,"offset":13214}},{"path":".github/workflows/portfolio-monitoring.yml","start":{"line":373,"col":41,"offset":13197},"end":{"line":373,"col":60,"offset":13216}},{"path":".github/workflows/portfolio-monitoring.yml","start":{"line":376,"col":22,"offset":13197},"end":{"line":376,"col":69,"offset":13244}},{"path":".github/workflows/portfolio-monitoring.yml","start":{"line":377,"col":21,"offset":13197},"end":{"line":377,"col":67,"offset":13243}},{"path":".github/workflows/portfolio-monitoring.yml","start":{"line":378,"col":25,"offset":13197},"end":{"line":378,"col":75,"offset":13247}},{"path":".github/workflows/portfolio-monitoring.yml","start":{"line":394,"col":6,"offset":13197},"end":{"line":394,"col":42,"offset":13233}}]],"message":"Syntax error at line .github/workflows/portfolio-monitoring.yml:372:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `{ needs.collect-metrics.outputs.timestamp` was unexpected","path":".github/workflows/portfolio-monitoring.yml","spans":[{"file":".github/workflows/portfolio-monitoring.yml","start":{"line":372,"col":18,"offset":13197},"end":{"line":372,"col":59,"offset":13238}},{"file":".github/workflows/portfolio-monitoring.yml","start":{"line":373,"col":17,"offset":13197},"end":{"line":373,"col":34,"offset":13214}},{"file":".github/workflows/portfolio-monitoring.yml","start":{"line":373,"col":41,"offset":13197},"end":{"line":373,"col":60,"offset":13216}},{"file":".github/workflows/portfolio-monitoring.yml","start":{"line":376,"col":22,"offset":13197},"end":{"line":376,"col":69,"offset":13244}},{"file":".github/workflows/portfolio-monitoring.yml","start":{"line":377,"col":21,"offset":13197},"end":{"line":377,"col":67,"offset":13243}},{"file":".github/workflows/portfolio-monitoring.yml","start":{"line":378,"col":25,"offset":13197},"end":{"line":378,"col":75,"offset":13247}},{"file":".github/workflows/portfolio-monitoring.yml","start":{"line":394,"col":6,"offset":13197},"end":{"line":394,"col":42,"offset":13233}}]}],"paths":{"scanned":[".claude/commands/action-sweep.md",".claude/commands/cloudflare-provision.md",".claude/commands/decision-memo.md",".claude/commands/deploy-pages.md",".claude/commands/execute-and-report.md",".claude/commands/hf-bridge-worker.md",".claude/commands/hf-space-demo.md",".claude/commands/hf-wire.md",".claude/commands/idea-sprint.md",".claude/commands/install-toolchain.md",".claude/commands/intake-booking.md",".claude/commands/marketplace-scaffold.md",".claude/commands/micro-offer-launch.md",".claude/commands/portfolio-review.md",".claude/commands/scaffold-site.md",".claude/commands/session-autoboot.md",".claude/commands/ship-artifact.md",".claude/commands/webhook-test-kit.md",".claude/commands/weekly-op-review.md",".claude/guardrails.json",".claude/settings.json",".github/CODEOWNERS",".github/actions/chatgpt-review/action.yml",".github/actions/chatgpt-review/package.json",".github/actions/chatgpt-review/src/index.ts",".github/actions/chatgpt-review/tsconfig.json",".github/pull_request_template.md",".github/workflows/actionlint.yml",".github/workflows/chatgpt-pr-review.yml",".github/workflows/codeql.yml",".github/workflows/e2e-tests.yml",".github/workflows/gatekeeper.yml",".github/workflows/gitleaks.yml",".github/workflows/playwright.yml",".github/workflows/portfolio-monitoring.yml",".github/workflows/repo-audit.yml",".github/workflows/scorecard.yml",".github/workflows/security.yml",".github/workflows/semgrep.yml",".gitignore",".mcp.json",".pre-commit-config.yaml","CHATGPT5_COMPREHENSIVE_AUDIT_PROMPT.md","CHATGPT5_STRATEGIC_CONSULTATION.md","CLAUDE_CODE_SECURITY_FRAMEWORK.md","CLAUDE_TO_CHATGPT5_ENHANCED_COLLABORATION.md","CLAUDE_TO_CHATGPT5_STATUS.md","PORTFOLIO_ANALYTICS_IMPLEMENTATION.md","README_Infrastructure_Mode.md","SECURITY_PLAN.md","audits/chatgpt5-integration-prompt.md","audits/claude-global-rules.md","audits/critical-project-level-framework.md","audits/reports/mcp-servers-audit.md","audits/reports/sub-agents-audit.md","audits/reports/tools-audit.md","docs/action-registry.jsonl","docs/analytics-setup.md","docs/bundle-upsell-config.v1.json","docs/chatgpt5-strategic-consultation-prompt.md","docs/claude-questions-for-chatgpt.md","docs/cloudflare-canonicalization.md","docs/hubspot-lead-scoring.v1.md","docs/journal/2025-08-13.md","docs/journal/2025-08-14.md","docs/marketplace/listing.md","docs/marketplace/marketplace-listing.md","docs/marketplace/marketplace-testing.md","docs/metrics/driftguard_marketplace_v1.md","docs/metrics/experiment_overlay_pricing_v1.md","docs/metrics/post_purchase_bundle_v1.md","docs/milestones.md","docs/outreach-pack.md","docs/overlay-studio-skus.v1.json","docs/pages-preview-setup.md","docs/policies/privacy.md","docs/policies/terms.md","docs/pricing-catalog.v2.json","docs/pricing.md","docs/project-mindmap.md","docs/reverse-trial-strategy.md","docs/seo-hygiene-checklist.md","docs/services-sow-templates.md","docs/subagent-registry.jsonl","docs/tool-registry.json","example.pdf","infra/cloudflare/README.md","infra/cloudflare/wrangler.templates/custom-domain.toml","infra/cloudflare/wrangler.templates/workers-dev.toml","infra/huggingface/README.md","infra/observability/README.md","infra/observability/terraform/main.tf","infra/observability/terraform/templates/incident-report.md.tpl","infra/observability/terraform/templates/monitoring-urls.md.tpl","infra/observability/terraform/terraform.tfvars.example","neuromap/MMTU-NeuroMap.json","neuromap/MMTU-NeuroMap.mmd","ops/launch-gates.yaml","ops/supabase-schema.sql","package.json","packages/analytics/package.json","packages/analytics/src/index.ts","packages/analytics/test.js","packages/analytics/test.simple.js","packages/entitlements/jest.config.js","packages/entitlements/package.json","packages/entitlements/src/index.d.ts","packages/entitlements/src/index.js","packages/entitlements/src/index.test.ts","packages/entitlements/src/index.ts","packages/entitlements/tsconfig.json","packages/entitlements/tsconfig.tsbuildinfo","packages/feature-flags/README.md","packages/feature-flags/migrations/001_feature_flags.sql","packages/feature-flags/package.json","packages/feature-flags/src/index.ts","packages/feature-flags/test.js","packages/feature-flags/tsconfig.json","packages/portfolio-analytics/package.json","packages/portfolio-analytics/src/cloudflare-integration.ts","packages/portfolio-analytics/src/dashboard-data.ts","packages/portfolio-analytics/src/dora-metrics.ts","packages/portfolio-analytics/src/index.ts","packages/portfolio-analytics/src/posthog-portfolio.ts","packages/portfolio-analytics/src/types.ts","packages/portfolio-analytics/tsconfig.json","packages/pricing-engine/package.json","packages/pricing-engine/src/index.ts","packages/pricing-engine/tsconfig.json","playwright-report/index.html","playwright.config.ts","pnpm-lock.yaml","pnpm-workspace.yaml","research/security/ai-agent-security-cli-tools.md","research/security/claude-code-security-integration.md","research/security/initial-findings.md","research/security/security-tools-integration.md","screenshot-mobile-dark.png","scripts/auto-bootstrap.sh","scripts/deploy-portfolio-analytics.sh","scripts/gatekeeper.ts","scripts/repo_audit.mjs","scripts/set_flag.ts","security-audit-results/ai-security.json","security-audit-results/semgrep-sast.json","security-audit-results/trivy-vulnerabilities.json","security-audit-results/trufflehog-secrets.json","test-google.png","test-python.py","test-results/results.json","trace-test.js","tsconfig.json","types/gatekeeper.d.ts","validate-scaffold.js"]},"time":{"rules":[],"rules_parse_time":1.4318299293518066,"profiling_times":{"config_time":4.601599931716919,"core_time":4.623924970626831,"ignores_time":0.0013649463653564453,"total_time":9.227427005767822},"parsing_time":{"total_time":1.5253760814666748,"per_file_time":{"mean":0.021484170161502454,"std_dev":0.004010974664023363},"very_slow_stats":{"time_ratio":0.4959779714909179,"count_ratio":0.028169014084507043},"very_slow_files":[{"fpath":"playwright-report/index.html","ftime":0.35662293434143066},{"fpath":"pnpm-lock.yaml","ftime":0.3999300003051758}]},"scanning_time":{"total_time":7.974877119064331,"per_file_time":{"mean":0.020767909164230013,"std_dev":0.018555905662954342},"very_slow_stats":{"time_ratio":0.30853292464819415,"count_ratio":0.0026041666666666665},"very_slow_files":[{"fpath":"pnpm-lock.yaml","ftime":2.460512161254883}]},"matching_time":{"total_time":3.640839099884033,"per_file_and_rule_time":{"mean":0.004728362467384222,"std_dev":538619.0888149498},"very_slow_stats":{"time_ratio":3955.400611730136,"count_ratio":0.003896103896103896},"very_slow_rules_on_files":[{"fpath":"pnpm-lock.yaml","rule_id":"yaml.kubernetes.security.legacy-api-clusterrole-excessive-permissions.legacy-api-clusterrole-excessive-permissions","time":0.10895490646362305},{"fpath":"pnpm-lock.yaml","rule_id":"yaml.kubernetes.security.allow-privilege-escalation-no-securitycontext.allow-privilege-escalation-no-securitycontext","time":0.4832909107208252},{"fpath":"pnpm-lock.yaml","rule_id":"yaml.docker-compose.security.exposing-docker-socket-volume.exposing-docker-socket-volume","time":14400.384957075119}]},"tainting_time":{"total_time":0.38021183013916016,"per_def_and_rule_time":{"mean":0.0005165921605151633,"std_dev":6.807761519712107e-07},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_defs":[]},"targets":[],"total_bytes":0,"max_memory_bytes":1112765568},"engine_requested":"OSS","skipped_rules":[]}                
                
┌──────────────┐
│ Scan Summary │
└──────────────┘
✅ Scan completed successfully.
 • Findings: 16 (16 blocking)
 • Rules run: 644
 • Targets scanned: 154
 • Parsed lines: ~99.7%
 • Scan skipped: 
   ◦ Files matching .semgrepignore patterns: 25
 • Scan was limited to files tracked by git
 • For a detailed list of skipped files and lines, run semgrep with the --verbose flag
Ran 644 rules on 154 files: 16 findings.

